set -x
set -e

`pwd`/CYCLOPTS/build.test.sh

cd libsigc++-2.3.1
./configure --prefix=`pwd`/../install
make
make install
cd ..

cd glibmm-2.30.0
./configure --prefix=`pwd`/../install PKG_CONFIG_PATH=`pwd`/../install/lib/pkgconfig/
make
make install
cd ..

cd libxml++-2.30.0
./configure --prefix=`pwd`/../install PKG_CONFIG_PATH=`pwd`/../install/lib/pkgconfig/
make
make install
cd ..

cd boost_1_50_0/
./bootstrap.sh
./bjam install --prefix=`pwd`/../install
cd ..

cd hdf5-1.8.4
./configure --prefix=`pwd`/../install
make
make install
cd ..
DIR=`pwd`

tar -czf results.tar.gz install coin-Cbc

cd cyclus
cmake `pwd`   -DCMAKE_INSTALL_PREFIX=`pwd`/../install -DCYCLOPTS_ROOT_DIR=`pwd`/../install -DCOIN_ROOT_DIR=`pwd`/../install -DBOOST_ROOT=`pwd`/../install  -DLAPACK_LIBRARIES="$DIR/coin-Cbc/ThirdParty/Lapack/.libs/libcoinlapack.so -llapack ;$DIR/coin-Cbc/ThirdParty/Blas/.libs/libcoinblas.so -lblas"
make
make install
cd ..

exit $?

